<!DOCTYPE html>
<html>
	<head>
		<title>Importance Configuration</title>
		<link rel='stylesheet' type='text/css' href='css/slate.min.css'>		
	</head>
	<body>
		<div class="item-container">
			<div class="item-container-header">Time</div>
			<div class="item-container-content">
				<label class="item">
					Display Seconds
					<input type="checkbox" class="item-toggle" id="seconds_toggle">
				</label>
			</div>
			<div class="item-container-footer">
				Please note that changing some of these settings could drastically impact battery life.
			</div>
		</div>
		<div class="item-container">
			<div class="item-container-header">Appearance</div>
			<div class="item-container-content">
				<label class="item">
					Color 1
					<input type="text" class="item-color item-color-normal" id="battery_fg_color" value="#00AAFF">
				</label>
				<label class="item">
					Color 2
					<input type="text" class="item-color item-color-normal" id="battery_bg_color" value="#0000AA">
				</label>
			</div>
		</div>
		<div class="item-container">
			<div class="button-container">
				<input type="button" class="item-button" value="SUBMIT" id="submit-button">
			</div>
		</div>
		
		<script src='js/slate.min.js'></script>
		<script>
		var submitButton = document.getElementById('submit-button');
		
		submitButton.addEventListener('click', function() {
			console.log('Submit clicked');
		
			var batteryBackgroundColor = document.getElementById('battery_bg_color');
			var batteryForegroundColor = document.getElementById('battery_fg_color');
			
			var options = {
				'battery_background_color': parseInt(batteryBackgroundColor.value, 16),
				'battery_foreground_color': parseInt(batteryForegroundColor.value, 16)
			};
			
			function getQueryParam(variable, defaultValue) {
			  var query = location.search.substring(1);
			  var vars = query.split('&');
			  for (var i = 0; i < vars.length; i++) {
				var pair = vars[i].split('=');
				if (pair[0] == variable) {
				  return decodeURIComponent(pair[1]);
				}
			  }
			  return defaultValue || false;
			}
			var return_to = getQueryParam('return_to', 'pebblejs://close#');

			// Encode and send the data when the page closes
			document.location = return_to + encodeURIComponent(JSON.stringify(options));
		});
	</script>
	</body>
</html>